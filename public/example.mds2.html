<!DOCTYPE html>
<html>
<head>
	 <meta charset="utf-8">
</head>
<body>

<script src="bin/proteinpaint.js" charset="utf-8"></script>

<noscript>This page requires JavaScript. Please enable it in your browser settings.</noscript>

<div id=aaa style="margin:10px"></div>

<script>

const dslabel = window.location.hash ? window.location.hash.slice(1) : 'SJLife'

runproteinpaint({
	holder:document.getElementById('aaa'),
	noheader:1,

	genome:'hg38',
	block:true,

	tracks:[

		{
			type:'mds2',
			dslabel,
			// customizations to the official track
			vcf:{
				numerical_axis:{
					// customization canceled
					AFtest:{
						groups:[
							{
								is_termdb:true,
								filter:{
									type:'tvslst',
									join:'',
									in:true,
									lst:[
										{
											type:"tvs",
											tag:"cohortFilter",
											renderAs:"htmlSelect",
											selectOptionsFrom:"selectCohort",
											tvs:{
												term:{id:"subcohort",type:"categorical"},
												values:[
													//{key:"SJLIFE",label:"SJLIFE"},
													{key:"CCSS",label:"CCSS"}
												]
											}
										},
									/*
										{type:'tvs',tvs: {
											term:{id:'diaggrp',name:'Diagnosis group',type:'categorical'},
											values:[{key:'Acute lymphoblastic leukemia',label:'Acute lymphoblastic leukemia'}],
										}},
										{type:'tvs',tvs:{
											term:{id:'agedx',type:'float',name:'Age at cancer diagnosis'},
											ranges:[{startunbounded:true,stop:8,stopinclusive:true,label:'<=8'}]
										}},
										{type:'tvs',tvs: {
											term: {id: "aaclassic_5", name: "Cumulative Alkylating Agent (Cyclophosphamide Equivalent Dose)", type:'float'},
											ranges: [ { value: '0', label: "Not exposed"},
												{startunbounded:true,stop:2000,stopinclusive:true}
											]
										}},
										//term:{id:'Asthma',name:'Asthma',type:'condition'},
										term:{id:'Arrhythmias',name:'Arrhythmias',type:'condition'},
										bar_by_grade:true,
										value_by_max_grade:true,
										values:[{key:1,label:'1 - mild'}],
										// range: {start: 0, stop: 3, startinclusive: true, name: "0 <= x < 3"},
										bar_by_grade:true,
										values:[{key:'Conduction abnormalities',label:'Conduction abnormalities'}]
										grade_and_child:[{
											grade:1,
											child_id:'Conduction abnormalities'
										}],
										*/
									]
								}
							},

/*
							{
								is_termdb:true,
								filter:{
									type:'tvslst',
									join:'and',
									in:true,
									lst:[
										{
											type:"tvs",
											tag:"cohortFilter",
											renderAs:"htmlSelect",
											selectOptionsFrom:"selectCohort",
											tvs:{
												term:{id:"subcohort",type:"categorical"},
												values:[
													{key:"SJLIFE",label:"SJLIFE"},
													{key:"CCSS",label:"CCSS"}
												]
											}
										},
										{type:'tvs',tvs: {
											term:{id:'diaggrp',name:'Diagnosis group',type:'categorical'},
											values:[{key:'Acute lymphoblastic leukemia',label:'Acute lymphoblastic leukemia'}],
										}},
										{type:'tvs',tvs:{
											term:{id:'agedx',type:'float',name:'Age at cancer diagnosis'},
											ranges:[{stopunbounded:true,start:8,label:'>8'}]
										}},
									]
								}
							}
							*/

							{ is_population:true, key:'gnomAD', allowto_adjust_race:true, adjust_race:true }
						]
					}
				}
			}
		},

		{
			hidden:1,
			type:'mds2',
			name:'test mds2',

			info_fields: [
				{
					key:'QC',
					label:'Good/Bad List',
					isfilter:true,
					isactivefilter:true,
					iscategorical:true,
					values:[
						{
							key:'Good',
							label:'Good'
						},
						{
							key:'Bad',
							label:'Bad',
							ishidden:true
						}
					]
				},
				{
					key:'AF',
					label:'SJLIFE allele frequency',
					isfilter:true,
					isfloat:1,
					range: {
						startunbounded:true,
						//startinclusive: bool
						stop: 0.1,
						stopinclusive:true
					}
				},
				{
					key:'gnomAD_AF',
					label:'gnomAD allele frequency',
					isfilter:true,
					isactivefilter:true,
					isfloat:1,
					range: {
						start: 0.1,
						startinclusive: true,
						stop: 1,
						stopinclusive:true
					}
				},
				{
					key:'gnomAD_AF_afr',
					label:'gnomAD African-American allele frequency',
					isfilter:true,
					isfloat:1,
					range: {
						start: 0.1,
						startinclusive: true,
						stop: 1,
						stopinclusive:true
					}
				},
				{
					key:'gnomAD_AF_eas',
					label:'gnomAD East Asian allele frequency',
					isfilter:true,
					isfloat:1,
					range: {
						start: 0.1,
						startinclusive: true,
						stop: 1,
						stopinclusive:true
					}
				},
				{
					key:'gnomAD_AF_nfe',
					label:'gnomAD non-Finnish European allele frequency',
					isfilter:true,
					isfloat:1,
					range: {
						start: 0.1,
						startinclusive: true,
						stop: 1,
						stopinclusive:true
					}
				},
				{
					key:'BadBLAT',
					isflag:true,
					isfilter:true,
					isactivefilter:true,
					remove_yes:true
				},
			],

			vcf:{
				file:'files/hg38/sjlife/vcf/SJLIFE.vcf.gz',
				numerical_axis: {
                    axisheight: 150,
                    info_keys: [
						{
							key:'AF',
							in_use:true,
							// TODO bind complex things such as boxplot to one of the info fields
						},
						{ key:'gnomAD_AF', missing_value: 0, },
						{ key:'gnomAD_AF_afr', missing_value: 0, },
						{ key:'gnomAD_AF_eas', missing_value: 0, },
						{ key:'gnomAD_AF_nfe', missing_value: 0, }
					],
                    in_use: true, // to use numerical axis by default
                },
                plot_mafcov: {
                    show_samplename: 1
                },
			}
		}

	],
	nativetracks:'RefGene',
	noheader:true,
	nobox:true
})
</script>

</body>
</html>
