Fixes:
- may detect the end of matrix data streaming using sampleIndex instead of the lastSampleId, which may not have data
